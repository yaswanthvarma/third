


#!/bin/bash

# Path to the certificate file
CERT_FILE="/path/to/mq_certificate.pem"

# Check certificate validity
CERT_EXPIRY_DATE=$(openssl x509 -enddate -noout -in "$CERT_FILE" | awk -F'=' '{print $2}')

# Convert expiry date to timestamp for comparison
CERT_EXPIRY_TIMESTAMP=$(date -d "$CERT_EXPIRY_DATE" +%s)
CURRENT_TIMESTAMP=$(date +%s)

# Calculate days until expiry
DAYS_LEFT=$(( ($CERT_EXPIRY_TIMESTAMP - $CURRENT_TIMESTAMP) / (60*60*24) ))

# Check if certificate will expire within 30 days
if [ $DAYS_LEFT -lt 30 ]; then
    # Send email alert
    echo "MQ Certificate will expire in $DAYS_LEFT days. Please renew." | mail -s "MQ Certificate Expiry Alert" your_email@example.com
fi









CRON entry
0 1 1 * * /local/web/check_mq_cert.sh